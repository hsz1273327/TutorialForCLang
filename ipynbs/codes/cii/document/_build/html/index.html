
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="cn">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Welcome to exception&#39;s documentation! &#8212; exception dev documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="welcome-to-exception-s-documentation">
<h1>Welcome to exception's documentation!<a class="headerlink" href="#welcome-to-exception-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>异常处理<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>C语言没有正紧的异常,一般来说是通过自己规定的返回码来标识异常的.</p>
<p>一般来说,程序中的错误可以分为3种:</p>
<ul>
<li><p class="first">用户错误</p>
<blockquote>
<div><p>预期会发生的错误,用户的特定操作就会导致特定的错误,比如注册邮箱时填入的内容没有&quot;&#64;&quot;这种.这种错误通常应该是程序主体就要处理的.通过返回特定的错误码进行提示.</p>
</div></blockquote>
</li>
<li><p class="first">运行时错误</p>
<blockquote>
<div><p>运行时错误从来都是非预期的,表明程序出了bug,程序必须要结束.通常需要使用断言来捕获这种错误</p>
</div></blockquote>
</li>
<li><p class="first">异常</p>
<blockquote>
<div><p>介于洪湖错误和程序bug之间,异常可能是比较罕见的错误,比如算数运算时候的溢出情况.通常异常不返回错误码,而是由恢复代码处理,类似于非局部的goto.</p>
</div></blockquote>
</li>
</ul>
<p>C语言中标准库提供了`setjmp`和`longjmp`是建立结构化异常处理的基础,具体来说,`setjmp`实例化一个处理程序,`longjmp`引发一个异常</p>
</div>
<div class="section" id="try-except">
<h2>try-except代码块<a class="headerlink" href="#try-except" title="Permalink to this headline">¶</a></h2>
<p>try-except代码块在现代编程语言中几乎是标配,在实践中也被证明非常有用.然而C中没有.
&quot;C语言接口与实现&quot;一书中有一个使用宏的实现,接下来会写一个库专门用于实现try-except代码块.不过有几个受限的使用形式:</p>
<ul>
<li><p class="first"><cite>TRY-END_TRY</cite></p>
<blockquote>
<div><p>相当于`{xxx}`语句不变只是引入一个新的作用域</p>
</div></blockquote>
</li>
<li><p class="first"><cite>TRY-ELSE-END_TRY</cite></p>
<blockquote>
<div><p>相当于python中的`try-except Exception`,只要有异常就处理,不管是啥异常</p>
</div></blockquote>
</li>
<li><p class="first"><cite>TRY-EXCEPT-...-END_TRY</cite></p>
<blockquote>
<div><p>相当于python中的`try-except E_1-except E_2-...`</p>
</div></blockquote>
</li>
<li><p class="first"><cite>TRY-EXCEPT-...-ELSE-END_TRY</cite></p>
<blockquote>
<div><p>注意这与python中不同,相当于python中的`try-except E_1-...- except Exception`</p>
</div></blockquote>
</li>
<li><p class="first"><cite>TRY-EXCEPT-FINALLY-END_TRY</cite></p>
<blockquote>
<div><p>相当于python中的`try-except E_1-finally`无论是否有异常都会执行FINALLY,
这个用法可以像python中的with语句一样提供一个上下文.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>TRY-EXCEPT-ELSE-FINALLY-END_TRY</cite></p>
<blockquote>
<div><p>相当于python中的`try-except E_1-except Exception-finally`无论是否有异常都会执行FINALLY,
这个用法可以像python中的with语句一样提供一个上下文.</p>
</div></blockquote>
</li>
<li><p class="first">如果`TRY`语句中需要执行返回,那么必须使用宏`RETURN`返回,</p>
<blockquote>
<div><p>不过需要注意如果代码段中有assert,且断言失败,那用RETURN回引起分段异常.</p>
</div></blockquote>
</li>
</ul>
<p>&quot;C语言接口与实现&quot;一书中提供的这组宏显然还是比较粗糙而且脆弱的,宏毕竟不会检查运行时错误,但一般用用足够.
C语言中并不提倡大量使用异常,设计算法的时候这组宏也应当被谨慎的使用.</p>
<p>这个模块在代码中有收录,它与下面的断言收录在一起.</p>
</div>
<div class="section" id="id2">
<h2>断言<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>C语言标准库有头文件`assert.h`将`assert(e)`定义为宏,`assert(e)`会计算表达式e的值,
如果e为0则向标准错误`stderr`写出诊断信息,并调用标准库函数abort退出程序执行.
诊断信息包含失败的断言文本和断言出现的坐标,该信息的格式是具体实现定义的.
<a href="#id3"><span class="problematic" id="id4">`</span></a>assert(0)`可以用户指明&quot;不可能发生&quot;的情况,当然如下也对:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span>assert(!&quot;ptr==NULL -- can&#39;t happen&quot;)
</pre></div>
</div>
<p>&quot;C语言接口与实现&quot;一书中提供了一个标准库&quot;assert.h&quot;的替代,用它的好处是如果断言失败不会向stderr打印消息,
也不会跳出程序,也不会提供表达式e的文本,而是抛出上文中定义的`Assert_Failed`异常.</p>
</div>
<div class="section" id="id5">
<h2>例子<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">_test_finally</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">){</span>
    <span class="nb">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">TRY</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
            <span class="n">RAISE</span><span class="p">(</span><span class="n">USER_EXCEPTION</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="k">assert</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="n">EXCEPT</span><span class="p">(</span><span class="n">USER_EXCEPTION</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">ELSE</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">FINALLY</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="n">END_TRY</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="c-api">
<h1>C API<a class="headerlink" href="#c-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="except">
<h2>except<a class="headerlink" href="#except" title="Permalink to this headline">¶</a></h2>
<p>异常处理 </p>
<p><dl class="docutils">
<dt><strong>Author</strong></dt>
<dd>David R. Hanson </dd>
<dt><strong>Date</strong></dt>
<dd>2018-1-9 </dd>
<dt><strong>Version</strong></dt>
<dd>0.0.1 </dd>
<dt><strong>LICENSE MIT</strong></dt>
<dd></dd>
<dt><strong>添加注释 hsz</strong></dt>
<dd></dd>
</dl>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="define">
<dt id="c.RAISE">
<span class="target" id="except_8h_1a45e87c4d7dee50346b15c7761b0b340a"></span><code class="descname">RAISE</code><span class="sig-paren">(</span>e<span class="sig-paren">)</span><a class="headerlink" href="#c.RAISE" title="Permalink to this definition">¶</a></dt>
<dd><p>抛出异常 </p>
</dd></dl>

<dl class="define">
<dt id="c.RERAISE">
<span class="target" id="except_8h_1a947ef43f0f0def3fcc050a8df849fd16"></span><code class="descname">RERAISE</code><a class="headerlink" href="#c.RERAISE" title="Permalink to this definition">¶</a></dt>
<dd><p>重复抛出异常 </p>
</dd></dl>

<dl class="define">
<dt id="c.RETURN">
<span class="target" id="except_8h_1a6a0e6b80dd3d5ca395cf58151749f5e2"></span><code class="descname">RETURN</code><a class="headerlink" href="#c.RETURN" title="Permalink to this definition">¶</a></dt>
<dd><p>返回 </p>
</dd></dl>

<dl class="define">
<dt id="c.TRY">
<span class="target" id="except_8h_1ad2746371528bdf15c3910b7bf217dac0"></span><code class="descname">TRY</code><a class="headerlink" href="#c.TRY" title="Permalink to this definition">¶</a></dt>
<dd><p>Try关键字 </p>
</dd></dl>

<dl class="define">
<dt id="c.EXCEPT">
<span class="target" id="except_8h_1ab5e72fc2bd41014c75e0ace4feabfe8e"></span><code class="descname">EXCEPT</code><span class="sig-paren">(</span>e<span class="sig-paren">)</span><a class="headerlink" href="#c.EXCEPT" title="Permalink to this definition">¶</a></dt>
<dd><p>EXCEPT关键字 </p>
</dd></dl>

<dl class="define">
<dt id="c.ELSE">
<span class="target" id="except_8h_1a0a70ee0cbf5b1738be4c9463c529ce72"></span><code class="descname">ELSE</code><a class="headerlink" href="#c.ELSE" title="Permalink to this definition">¶</a></dt>
<dd><p>ELSE关键字 </p>
</dd></dl>

<dl class="define">
<dt id="c.FINALLY">
<span class="target" id="except_8h_1a0e2a75478cd44f1666a6aca626c5c50b"></span><code class="descname">FINALLY</code><a class="headerlink" href="#c.FINALLY" title="Permalink to this definition">¶</a></dt>
<dd><p>FINALLY关键字 </p>
</dd></dl>

<dl class="define">
<dt id="c.END_TRY">
<span class="target" id="except_8h_1ae6628ac788ad213363b89dba9868420b"></span><code class="descname">END_TRY</code><a class="headerlink" href="#c.END_TRY" title="Permalink to this definition">¶</a></dt>
<dd><p>END_TRY关键字 </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Typedefs</p>
<dl class="typedef">
<dt id="c.Except_T">
<span class="target" id="except_8h_1a98478a2812528f65d7086212661a4bc3"></span><em class="property">typedef </em>struct <a class="reference internal" href="#c.Except_T" title="Except_T">Except_T</a>  <code class="descname">Except_T</code><a class="headerlink" href="#c.Except_T" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="typedef">
<dt id="c.Except_Frame">
<span class="target" id="except_8h_1ae9476933f67b88456bce2b1445851f6f"></span><em class="property">typedef </em>struct <a class="reference internal" href="#c.Except_Frame" title="Except_Frame">Except_Frame</a> <code class="descname">Except_Frame</code><a class="headerlink" href="#c.Except_Frame" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Enums</p>
<dl class="enum">
<dt id="c.__anonymous0">
<span class="target" id="except_8h_1a06fc87d81c62e9abb8790b6e5713c55b"></span><em class="property">enum </em><code class="descname"><strong>[anonymous]</strong></code><a class="headerlink" href="#c.__anonymous0" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Values:</em></p>
<dl class="enumvalue">
<dt id="c.Except_entered">
<span class="target" id="except_8h_1a06fc87d81c62e9abb8790b6e5713c55ba388ad603a03109702c508bd464b66da2"></span><code class="descname">Except_entered</code> = 0<a class="headerlink" href="#c.Except_entered" title="Permalink to this definition">¶</a></dt>
<dd><p>进入异常处理块状态 </p>
</dd></dl>

<dl class="enumvalue">
<dt id="c.Except_raised">
<span class="target" id="except_8h_1a06fc87d81c62e9abb8790b6e5713c55ba80cdb3635fb4b8d00925dea5821c9fbb"></span><code class="descname">Except_raised</code><a class="headerlink" href="#c.Except_raised" title="Permalink to this definition">¶</a></dt>
<dd><p>抛出异常处理状态 </p>
</dd></dl>

<dl class="enumvalue">
<dt id="c.Except_handled">
<span class="target" id="except_8h_1a06fc87d81c62e9abb8790b6e5713c55bac0d9956bf062b2f2db1f9294563e73b4"></span><code class="descname">Except_handled</code><a class="headerlink" href="#c.Except_handled" title="Permalink to this definition">¶</a></dt>
<dd><p>异常处理中状态 </p>
</dd></dl>

<dl class="enumvalue">
<dt id="c.Except_finalized">
<span class="target" id="except_8h_1a06fc87d81c62e9abb8790b6e5713c55ba8f2b6b8b0f719ecda31559637209f40b"></span><code class="descname">Except_finalized</code><a class="headerlink" href="#c.Except_finalized" title="Permalink to this definition">¶</a></dt>
<dd><p>异常处理块结束状态 </p>
</dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="c.Except_raise">
<span class="target" id="except_8h_1a9199ea10e7cd2cf2422ae8ffa9ac43a1"></span>void <code class="descname">Except_raise</code><span class="sig-paren">(</span>const  <a class="reference internal" href="#c.Except_T" title="Except_T">Except_T</a>  *<em>&nbsp;e</em>, const char *<em>&nbsp;file</em>, int<em>&nbsp;line</em><span class="sig-paren">)</span><a class="headerlink" href="#c.Except_raise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Variables</p>
<dl class="variable">
<dt id="c.Except_stack">
<span class="target" id="except_8h_1a3d38c6361ecf1c4873bbcb2de8a50874"></span><a class="reference internal" href="#c.Except_Frame" title="Except_Frame">Except_Frame</a>* <code class="descname">Except_stack</code><a class="headerlink" href="#c.Except_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>实例化一个异常栈 </p>
</dd></dl>

<dl class="variable">
<dt id="c.Assert_Failed">
<span class="target" id="except_8h_1a02c91dd1cedbfe4b9e31d7775e0ead7f"></span>const <a class="reference internal" href="#c.Except_T" title="Except_T">Except_T</a> <code class="descname">Assert_Failed</code><a class="headerlink" href="#c.Assert_Failed" title="Permalink to this definition">¶</a></dt>
<dd><p>定义Assert_Failed异常 </p>
</dd></dl>

</div>
<dl class="struct">
<dt>
<span class="target" id="struct_except___t"></span><em class="property">struct </em><code class="descname">Except_T</code></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.Except_T::reason">
<span class="target" id="struct_except___t_1a6a35b57fc58f0ba7cc0d4f939dd3f773"></span>const char* <code class="descname">reason</code><a class="headerlink" href="#c.Except_T::reason" title="Permalink to this definition">¶</a></dt>
<dd><p>reason str 原因字符串 </p>
</dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt>
<span class="target" id="struct_except___frame"></span><em class="property">struct </em><code class="descname">Except_Frame</code></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="c.Except_Frame::prev">
<span class="target" id="struct_except___frame_1a4a5323a9c98b198d171a7f0409f3bbae"></span><a class="reference internal" href="#c.Except_Frame" title="Except_Frame">Except_Frame</a>* <code class="descname">prev</code><a class="headerlink" href="#c.Except_Frame::prev" title="Permalink to this definition">¶</a></dt>
<dd><p>异常帧指针 </p>
</dd></dl>

<dl class="variable">
<dt id="c.Except_Frame::env">
<span class="target" id="struct_except___frame_1abce4b8de2bbf7d6fb6ef52d618309264"></span>jmp_buf <code class="descname">env</code><a class="headerlink" href="#c.Except_Frame::env" title="Permalink to this definition">¶</a></dt>
<dd><p>用于处理嵌套异常 </p>
</dd></dl>

<dl class="variable">
<dt id="c.Except_Frame::file">
<span class="target" id="struct_except___frame_1a4c8d0ea0c9437ede53e8703feefe0dc6"></span>const char* <code class="descname">file</code><a class="headerlink" href="#c.Except_Frame::file" title="Permalink to this definition">¶</a></dt>
<dd><p>报异常文件 </p>
</dd></dl>

<dl class="variable">
<dt id="c.Except_Frame::line">
<span class="target" id="struct_except___frame_1aff1099dac68f6f3b8392f2ebe5c8341f"></span>int <code class="descname">line</code><a class="headerlink" href="#c.Except_Frame::line" title="Permalink to this definition">¶</a></dt>
<dd><p>报异常的行号 </p>
</dd></dl>

<dl class="variable">
<dt id="c.Except_Frame::exception">
<span class="target" id="struct_except___frame_1a41f49d856fa1e252bc5f7439f6feeaf8"></span>const <a class="reference internal" href="#c.Except_T" title="Except_T">Except_T</a>* <code class="descname">exception</code><a class="headerlink" href="#c.Except_Frame::exception" title="Permalink to this definition">¶</a></dt>
<dd><p>异常实例指针 </p>
</dd></dl>

</div>
</dd></dl>

</div>
<div class="section" id="assert">
<h2>assert<a class="headerlink" href="#assert" title="Permalink to this headline">¶</a></h2>
<p>断言库 </p>
<p><dl class="docutils">
<dt><strong>Author</strong></dt>
<dd>David R. Hanson </dd>
<dt><strong>Date</strong></dt>
<dd>2018-1-9 </dd>
<dt><strong>Version</strong></dt>
<dd>0.0.1 </dd>
<dt><strong>LICENSE MIT</strong></dt>
<dd></dd>
<dt><strong>添加注释 hsz</strong></dt>
<dd></dd>
</dl>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="define">
<dt id="c.assert">
<span class="target" id="assert_8h_1ad6d5aaa966ca7424f7cb9bd01f2c838b"></span><code class="descname">assert</code><span class="sig-paren">(</span>e<span class="sig-paren">)</span><a class="headerlink" href="#c.assert" title="Permalink to this definition">¶</a></dt>
<dd><p>断言宏 </p>
<p>[e] int 错误码 </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt>
<span class="target" id="assert_8h_1ad9980b4bb08dbab85cdca0ecb15c92ce"></span>void <code class="descname">assert</code><span class="sig-paren">(</span>int<em>&nbsp;e</em><span class="sig-paren">)</span></dt>
<dd><p>断言函数 </p>
<p>[e] int 错误码 </p>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, hsz.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>