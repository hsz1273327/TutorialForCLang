
# 自定义结构

## 枚举

枚举在python中并没有直接的实现,但C++中它是默认的一种自定义类型,它的声明关键字是enum

声明枚举类型:

```c
enum 枚举类型名 {枚举值1,枚举值2...} 
```

定义枚举变量:

```c
枚举类型名 变量名 = 枚举值;
```
需要注意的是枚举类型变量只能赋值为枚举类型声明时的枚举值,其他都会报错,而枚举值实际上是对应声明时位置对应的整形数.

看个例子:


```python
%%writefile src/C7/weekdays.cpp

#include <stdio.h>

enum Weekday {MON,TUE,WED,THU,FRI,SAT,SUN};

int main(void) {
    enum Weekday firstday = TUE;
    printf("first day is %d\n",firstday );
    return 0;
}
```

    Overwriting src/C7/weekdays.cpp



```python
!g++-7 -o bin/weekdays src/C7/weekdays.cpp
```


```python
!bin/weekdays
```

    first day is 1


## 结构体

结构体可以理解为一组有意义的特殊成员变量的组合,比如对于小朋友,有性别,姓名,年龄身高,体重这几个维度,每个小朋友都会有这些属性.我们就可以将小朋友定义为一个结构体

结构体的定义方式为:

```c
struct 结构名{
类型 成员变量名;
类型 成员变量名;
类型 成员变量名;
};

```

注意不要落了封号

我们来声明一个Child结构体

```c
struct Child{
    char name[10];
    char sex[2];
    int age;
    float weight;
    float height; 
};
```


### 结构体变量的初始化

结构体是一种自定义类型,它和一般的类型如int呀char呀有相同的性质,不同之处是他是值是复合的,要非初始化上面的结构体结构体,只要这样:

```c
struct Child Tom = {{"T","o","m","\0"},{"m","\0"},8,48.5,1.5};
```
也可以声明变量后再赋值

```c
struct Child Sam;
Sam.name = "Sam";
Sam.sex = "m";
Sam.age = 7;
Sam.weight = 45.7;
Sam.height = 1.57;
```

### 结构体变量的特性

结构体变量作为函数参数传递的时候需要注意是**传值**的,这和一般的类型是一样的.
如果我们的函数参数是结构体的指针变量(传引用),那么和一般的指针变量一样,需要注意.

## 共用体

在C语言中,还有另外一种和结构体非常类似的语法,叫做共用体(Union),它的定义格式为:
```C
union 共用体名{
    成员列表
};
```

结构体和共用体的区别在于:

+ 结构体的各个成员会占用不同的内存,互相之间没有影响;
+ 共用体的所有成员占用同一段内存,修改一个成员会影响其余所有成员.

结构体占用的内存大于等于所有成员占用的内存的总和(成员之间可能会存在缝隙),共用体占用的内存等于最长的成员占用的内存.共用体使用了内存覆盖技术，同一时刻只能保存一个成员的值，如果对新的成员赋值，就会把原来成员的值覆盖掉.


```python
%%writefile src/C7/uniontest.cpp

#include <stdio.h>
union data{
    int n;
    char ch;
    short m;
};
int main(){
    union data a;
    printf("%d, %d\n", sizeof(a), sizeof(union data) );
    a.n = 0x40;
    printf("%X, %c, %hX\n", a.n, a.ch, a.m);
    a.ch = '9';
    printf("%X, %c, %hX\n", a.n, a.ch, a.m);
    a.m = 0x2059;
    printf("%X, %c, %hX\n", a.n, a.ch, a.m);
    a.n = 0x3E25AD54;
    printf("%X, %c, %hX\n", a.n, a.ch, a.m);
   
    return 0;
}
```

    Overwriting src/C7/uniontest.cpp



```python
!g++-7 -o bin/uniontest src/C7/uniontest.cpp
```


```python
!bin/uniontest
```

    4, 4
    40, @, 40
    39, 9, 39
    2059, Y, 2059
    3E25AD54, T, AD54


## 自定义类型操作

我们可以使用`typedef`关键字将结构体或者枚举,或者其他任何的类型取个别名,这样可以更加方便使用

```c
typedef 原类型 类型别名;

```

> 例子:


```python
%%writefile src/C7/child.cpp

#include <stdio.h>
#include <string.h>
typedef struct{
    char name[10];
    char sex[2];
    int age;
    float weight;
    float height;
} Child;

int main(void) {
    Child Tom = {"Tom","m",8,48.5,1.5};
    Child Sam;
    strcpy(Sam.name,"Sam");
    strcpy(Sam.sex,"m");
    Sam.age = 7;
    Sam.weight = 45.7;
    Sam.height = 1.57;
    printf("%s 身高%fm\n",Tom.name,Tom.height);
    printf("%s 体重%fkg\n",Sam.name,Sam.weight);
    return 0;
}

```

    Overwriting src/C7/child.cpp



```python
!g++-7 -o bin/child src/C7/child.cpp
```


```python
!bin/child
```

    Tom 身高1.500000m
    Sam 体重45.700001kg

